<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog
	xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.5.xsd">

	<!-- Change set for table bank -->

	<changeSet author="pramod" id="bank.1">
		<createTable tableName="bank">
			<column autoIncrement="true" name="id" type="INT">
				<constraints primaryKey="true" />
			</column>
			<column name="name" type="VARCHAR(255)" />
			<column name="type" type="VARCHAR(255)" />
			<column name="head_office" type="VARCHAR(255)" />
		</createTable>
	</changeSet>

	<!--ChangeSet for the table "ATM" -->
	<changeSet author="pramod" id="atm.1">

		<createTable tableName="atm">

			<column autoIncrement="true" name="id" type="INT">
				<constraints primaryKey="true" />
			</column>

			<column name="location" type="VARCHAR(255)" />

			<column name="amountofcash" type="DOUBLE" />

			<column name="bank_id" type="int">
				<constraints nullable="true" />
			</column>

		</createTable>
	</changeSet>

	<!-- Foreign key Constraints for Atm Entity -->
	<changeSet author="pramod" id="atm.2">
		<addForeignKeyConstraint
			constraintName="fk_bank_atm_id" baseColumnNames="bank_id"
			baseTableName="atm" referencedColumnNames="id"
			referencedTableName="bank" />
	</changeSet>

	<!-- Change set for table employee -->
	<changeSet author="pramod" id="employee.1">

		<createTable tableName="employee">

			<column autoIncrement="true" name="id" type="INT">
				<constraints primaryKey="true" />
			</column>

			<column name="name" type="VARCHAR(255)" />
			<column name="type" type="VARCHAR(255)" />
			<column name="salary" type="DOUBLE" />

			<column name="bank_id" type="int">
				<constraints nullable="true" />
			</column>

		</createTable>
	</changeSet>

	<!-- Foreign key Constraints for Employee Entity -->
	<changeSet author="pramod" id="employee.2">
		<addForeignKeyConstraint
			constraintName="fk_bank_employee_id" baseColumnNames="bank_id"
			baseTableName="employee" referencedColumnNames="id"
			referencedTableName="bank" />
	</changeSet>

	<!--ChangeSet for the table "Shareholders" -->
	<changeSet author="pramod" id="shareholders.1">

		<createTable tableName="shareholders">

			<column autoIncrement="true" name="id" type="INT">
				<constraints primaryKey="true" />
			</column>

			<column name="name" type="VARCHAR(255)" />
			<column name="bank_id" type="int">
				<constraints nullable="true" />
			</column>

		</createTable>
	</changeSet>

	<!-- Foreign key Constraints for Employee Entity -->
	<changeSet author="pramod" id="shareholders.2">
		<addForeignKeyConstraint
			constraintName="fk_bank_shareholders_id" baseColumnNames="bank_id"
			baseTableName="shareholders" referencedColumnNames="id"
			referencedTableName="bank" />
	</changeSet>

	<!--ChangeSet for the table "branch" -->
	<changeSet author="pramod" id="branch.1">

		<createTable tableName="branch">

			<column autoIncrement="true" name="id" type="INT">
				<constraints primaryKey="true" />
			</column>

			<column name="type" type="VARCHAR(255)" />
			<column name="location" type="VARCHAR(255)" />
			<column name="bank_id" type="int">
				<constraints nullable="true" />
			</column>

		</createTable>
	</changeSet>

	<!-- Foreign key Constraints for branch Entity -->
	<changeSet author="pramod" id="branch.2">
		<addForeignKeyConstraint
			constraintName="fk_bank_branch_id" baseColumnNames="bank_id"
			baseTableName="branch" referencedColumnNames="id"
			referencedTableName="bank" />
	</changeSet>

	<!--ChangeSet for the table "account" -->
	<changeSet author="pramod" id="account.1">

		<createTable tableName="account">

			<column autoIncrement="true" name="id" type="INT">
				<constraints primaryKey="true" />
			</column>

			<column name="accountno" type="LONG" />
			<column name="balance" type="DOUBLE" />
			<column name="overdraft" type="DOUBLE" />

		</createTable>
	</changeSet>

	<!-- Change Set for table insurance -->

	<changeSet author="pramod" id="insurance.1">
		<createTable tableName="insurance">
			<column autoIncrement="true" name="id" type="INT">
				<constraints primaryKey="true" />
			</column>

			<column name="issuing_company" type="VARCHAR(255)" />
			<column name="type" type="VARCHAR(255)" />
			<column name="premium_payment" type="DOUBLE" />
			<column name="term" type="INT" />
		</createTable>

	</changeSet>

	<!--ChangeSet for the table "customer" -->
	<changeSet author="pramod" id="customer.1">

		<createTable tableName="customer">

			<column autoIncrement="true" name="id" type="INT">
				<constraints primaryKey="true" />
			</column>
			<column name="name" type="VARCHAR(255)" />
			<column name="dob" type="date" />
			<column name="address" type="VARCHAR(255)" />
			<column name="accountno" type="LONG" />
			<column name="balance" type="DOUBLE" />
			<column name="overdraft" type="DOUBLE" />

			<column name="bank_id" type="int">
				<constraints nullable="true" />
			</column>
			<column name="insurance_id" type="int">
				<constraints nullable="true" />
			</column>

		</createTable>
	</changeSet>

	<!-- Foreign key Constraints for customer Entity -->
	<changeSet author="pramod" id="customer.2">
		<addForeignKeyConstraint
			constraintName="fk_bank_customer_id" baseColumnNames="bank_id"
			baseTableName="customer" referencedColumnNames="id"
			referencedTableName="bank" />
	</changeSet>

	<changeSet author="pramod" id="customer.3">
		<addForeignKeyConstraint
			constraintName="fk_insurance_customer_id"
			baseColumnNames="insurance_id" baseTableName="customer"
			referencedColumnNames="id" referencedTableName="insurance" />
	</changeSet>

	<!--ChangeSet for the table "Card" -->

	<changeSet author="pramod" id="card.1">

		<createTable tableName="card">
			<column autoIncrement="true" name="id" type="INT">
				<constraints primaryKey="true" />
			</column>

			<column name="cardno" type="LONG" />
			<column name="validfrom" type="VARCHAR(255)" />
			<column name="validto" type="VARCHAR(255)" />

			<column name="account_id" type="int">
				<constraints nullable="true" />
			</column>
			<column name="customer_id" type="int">
				<constraints nullable="true" />
			</column>

		</createTable>
	</changeSet>

	<!-- Foreign key Constraints for customer Entity -->
	<changeSet author="pramod" id="card.2">
		<addForeignKeyConstraint
			constraintName="fk_card_account_id" baseColumnNames="account_id"
			baseTableName="card" referencedColumnNames="id"
			referencedTableName="account" />
	</changeSet>

	<changeSet author="pramod" id="card.3">
		<addForeignKeyConstraint
			constraintName="fk_card_customer_id" baseColumnNames="customer_id"
			baseTableName="card" referencedColumnNames="id"
			referencedTableName="customer" />
	</changeSet>

	<!--ChangeSet for the table loan -->

	<changeSet author="pramod" id="loan.1">
		<createTable tableName="loan">
			<column autoIncrement="true" name="id" type="INT">
				<constraints primaryKey="true" />
			</column>


			<column name="amount" type="Double" />
			<column name="loanType" type="VARCHAR(255)" />
			<column name="rateOfInterest" type="Double" />
			<column name="term" type="VARCHAR(255)" />

			<column name="account_id" type="int">
				<constraints nullable="true" />
			</column>

		</createTable>
	</changeSet>

	<!-- Foreign key Constraints for customer Entity -->
	<changeSet author="pramod" id="loan.2">
		<addForeignKeyConstraint
			constraintName="fk_loan_account_id" baseColumnNames="account_id"
			baseTableName="loan" referencedColumnNames="id"
			referencedTableName="account" />
	</changeSet>

	<!--ChangeSet for the table "Shareholders" -->
	<changeSet author="pramod" id="shareholders.1">

		<createTable tableName="shareholders">

			<column autoIncrement="true" name="id" type="INT">
				<constraints primaryKey="true" />
			</column>

			<column name="name" type="VARCHAR(255)" />

			<column name="bank_id" type="int">
				<constraints nullable="true" />
			</column>

		</createTable>
	</changeSet>

	<!-- Foreign key Constraints for customer Entity -->
	<changeSet author="pramod" id="shareholders.2">
		<addForeignKeyConstraint
			constraintName="fk_bank_shareholders_id" baseColumnNames="bank_id"
			baseTableName="shareholders" referencedColumnNames="id"
			referencedTableName="bank" />
	</changeSet>

	<!--ChangeSet for the table shares -->
	<changeSet author="pramod" id="shares.1">

		<createTable tableName="shares">
			<column autoIncrement="true" name="id" type="INT">
				<constraints primaryKey="true" />
			</column>

			<column name="number" type="DOUBLE" />
			<column name="value" type="DOUBLE" />
			<column name="type" type="VARCHAR(255)" />
			<column name="equity" type="DOUBLE" />
			<column name="preferrential" type="VARCHAR(255)" />

			<column name="shareholders_id" type="int">
				<constraints nullable="true" />
			</column>

		</createTable>
	</changeSet>

	<!-- Foreign key Constraints for customer Entity -->
	<changeSet author="pramod" id="shares.2">
		<addForeignKeyConstraint
			constraintName="fk_bank_shares_id" baseColumnNames="shareholders_id"
			baseTableName="shares" referencedColumnNames="id"
			referencedTableName="shareholders" />
	</changeSet>

	<!-- Creating table Account_Type -->
	<changeSet author="sujay" id="account_type.1">

		<createTable tableName="account_type">
			<column autoIncrement="true" name="id" type="INT">
				<constraints primaryKey="true" />
			</column>

			<column name="transactionlimit" type="DOUBLE" />
			<column name="depositamt" type="DOUBLE" />
			<column name="withdrawllimit" type="DOUBLE" />
			<column name="interestrate" type="DOUBLE" />

			<column name="account_id" type="int">
				<constraints nullable="true" />
			</column>

		</createTable>
	</changeSet>

	<!-- Foreign key Constraints for Account_Type Entity -->
	<changeSet author="sujay" id="account_type.2">
		<addForeignKeyConstraint
			constraintName="fk_account_accountType_id"
			baseColumnNames="account_id" baseTableName="account_type"
			referencedColumnNames="id" referencedTableName="account" />
	</changeSet>

	<!-- adding Employyee_id column to Customer -->
	<changeSet author="sujay" id="customer.4">
		<addColumn tableName="customer">
			<column name="employee_id" type="int" />
		</addColumn>
	</changeSet>

	<!-- Foreign key Constraints for Account_Type Entity -->
	<changeSet author="sujay" id="customer.5">
		<addForeignKeyConstraint
			constraintName="fk_customer_employee_id"
			baseColumnNames="employee_id" baseTableName="customer"
			referencedColumnNames="id" referencedTableName="employee" />
	</changeSet>
	
	<!-- adding PAN_NO column to Customer -->
	<changeSet author="sujay" id="customer.6">
		<addColumn tableName="customer">
			<column name="panno" type="VARCHAR(255)" />
		</addColumn>
	</changeSet>

	<!-- adding account_type_id column to Account -->
	<changeSet author="sujay" id="account.3">
		<addColumn tableName="account">
			<column name="account_type_id" type="int" />
		</addColumn>
	</changeSet>
	
	<!-- Foreign key Constraints for Account -->
	<changeSet author="sujay" id="account.4">
		<addForeignKeyConstraint
			constraintName="fk_accountType_account_id"
			baseColumnNames="account_type_id" baseTableName="account"
			referencedColumnNames="id" referencedTableName="account_type" />
	</changeSet>
	
	<!-- adding account_type_id column to Account -->
	<changeSet author="sujay" id="account.5">
		<addColumn tableName="account">
			<column name="customer_id" type="int" />
		</addColumn>
	</changeSet>
	
	<!-- Foreign key Constraints for Account -->
	<changeSet author="sujay" id="account.6">
		<addForeignKeyConstraint
			constraintName="fk_account_customer_id"
			baseColumnNames="customer_id" baseTableName="account"
			referencedColumnNames="id" referencedTableName="customer" />
	</changeSet>

	<!-- adding loans_id column to Account -->
	<changeSet author="sujay" id="account.7">
		<addColumn tableName="account">
			<column name="loans_id" type="int" />
		</addColumn>
	</changeSet>
	
	<!-- Foreign key Constraints for Account -->
	<changeSet author="sujay" id="account.8">
		<addForeignKeyConstraint
			constraintName="fk_account_loans_id"
			baseColumnNames="loans_id" baseTableName="account"
			referencedColumnNames="id" referencedTableName="loan" />
	</changeSet>
	
</databaseChangeLog>
